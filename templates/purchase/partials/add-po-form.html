<table class="table add-po-form">
<tr class="bg-success">
	<th width="150">
		<label for="id_po_number">PO Number:</label>
	</th>
	<td colspan="3">
		<div style="position: relative;">
			<input class="form-control" ng-model='search_po' maxlength="25" id="id_po_number_search"  type="search" name="po_number_search" ng-change="searchPo(search_po)" placeholder="Search for PO by Customer Name, Address, Phone Number, Item Description, PO Number or leave Blank for New PO" autocomplete="off" ng-disabled="po_checked">
			
			<div id="po_list" ng-show="show_po_list">
				<table class="table">
					<thead>
						<tr>
							<td>PO Number</td>
							<td>PO Status</td>
							<td>Supplier</td>
							<td>Terms</td>
							<td>Shipping Inst</td>	
							<th><a class="close" ng-click="closeMe()">X</a></th>
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="po in pos | filter:search_po" ng-click="selectPo(po)">
							<td>{[{po.po_number}]}</td>
							<td>{[{po.po_status}]}</td>
							<td>{[{po.supplier}]}</td>
							<td>{[{po.terms}]}</td>
							<td>{[{po.shipping_inst}]}</td>
							<td></td>
						</tr>
						<tr ng-show="!pos.length">
							<td colspan="6">
								No PO found!
							</td>
						</tr>
						
					</tbody>
					
				</table>
				
			</div>
			<div ng-show="!pos.length && show_po_list">
				No Purchase Order Found!
			</div>
		</div>
		<input id="id_po_number" name="po_number" type="hidden">
		
		<input class="form-control" id="id_next_number" name="next_number" type="hidden" value="{{next_po_number}}">
	</td>
</tr>
<tr class="bg-info">
	<th width="150">
		<label for="id_date_issued">Date issued:</label>
	</th>
	<td>
		<input ng-model="dateIssued" class="form-control datepicker" id="id_date_issued" name="date_issued" value="{[{dateIssued}]}" placeholder="date issued" type="text" >
	</td>
	<th width="150">
		<label for="id_date_expected">Date expected:</label>
	</th>
	<td>


		<input class="form-control datepicker" id="id_date_expected" name="date_expected" placeholder="date expected" type="text">
	</td>
	
</tr>

<tr class="bg-success">
	<th width="150" ng-class="{'ng-pristine': purchase_add_form.search_supplier.$pristine || purchase_add_form.search_supplier.$invalid}">
		<label for="id_supplier">Supplier:</label>
	</th>
	<td colspan="3">
	<div class="contact_box">
		<input type="text" ng-model="search_supplier" placeholder="start typing to search supplier" class="form-control" name="search_supplier" ng-required='true' ng-change="searchSupplier(search_supplier)" >
		<span ng-show="purchase_add_form.search_supplier.$dirty && purchase_add_form.search_supplier.$error.required">*This field is required.</span>

		<table class="table" id="supplier_contact_details" ng-show="supplier_contact">
			<tr>
				<th width="150">Contact Name</th>
				<td colspan="2">{[{ supplier_contact.contact_name }]}</td>
			</tr>
			<tr>
				<th>City</th>
				<td colspan="2">{[{ supplier_contact.city }]}</td>
			</tr>
			<tr>
				<th>Province</th>
				<td colspan="2">{[{ supplier_contact.province }]}</td>
			</tr>
			<tr>
				<th>Country</th>
				<td colspan="2">{[{ supplier_contact.country }]}</td>
			</tr>
			<tr>
				<th>Emails</th>
				<td colspan="2">
					<li ng-repeat="em in supplier_contact.emails">
						<span class='bg-info email'>{[{ em.email_address}]} ({[{em.email_type}]})</span>
					</li>
				</td>
			</tr>
			<tr>
				<th colspan="3">
					<a class="btn btn-info" ng-click="addExtraContact()">
						Add Extra Contact
					</a>
				</th>
			</tr>
			<tfoot class="extra-contact">
					
			</tfoot>
			
			
		</table>

		<table class="table selectable" class="ui-autocomplete ui-widget-content-custom ui-corner-all" id="supplier_contact_list">
			<thead>
				<tr>
					<th>ID</th><th>Contact Name</th><th>Address 1</th><th> Country </th>
					<th> Province </th><th> City </th><th> Primary Cont No.</th>
					<th><a href="" class="close" ng-click="hideSupplierContact()">x</a></th>
				</tr>
			</thead>
			<tbody>
			<tr class="ui-menu-item" ng-repeat="contact in suppliers" ng-click="setSupplier(contact)">
				
				<td class="sid">{[{contact.id}]}</td>
				<td class="contact_name">{[{contact.contact_name}]}</td>
				<td class="address_1">{[{contact.address_1}]}</td>
				<td class="city">{[{contact.country}]}</td>
				<td class="city">{[{contact.province}]}</td>
				<td class="city">{[{contact.city}]}</td>
				<td class="city">
					<div class='phone' ng-repeat="phon in contact.phones" ng-if="$first">
						<span>{[{phon.number}]} (ext: {[{phon.phone_ext}]})</span>
					</div>
				</td>
				
				<td>
					
				</td>
				
			</tr>
			</tbody>
		</table>

		<input type="hidden" name="supplier" id="id_supplier">
	</div>


	</td>
</tr>
<tr>
	<th width="150">
		<label for="id_ship_to">Ship to:</label>
	</th>
	<td colspan="3">
	<div class="contact_box">
		
	
		<input type="text" ng-model="search_ship_to" placeholder="start typing to search ship to contact" class="form-control" ng-change="searchShipTo(search_ship_to)">
		<table class="table" id="ship_to_contact_details">
			<tr>
				<th width="150">Contact Name</th>
				<td>{[{ ship_to_contact.contact_name }]}</td>
			</tr>
			<tr>
				<th>Phone</th>
				<td>
					<li ng-repeat='phone in ship_to_contact.phones'>
						{[{ phone.type }]}: {[{phone.number}]} (ext-{[{phone.ext}]})
					</li>
				</td>
			</tr>
			<tr>
				<th>Email</th>
				<td>
					<li ng-repeat="em in supplier_contact.emails">
						<span class='bg-info email'>{[{ em.email_address}]} ({[{em.email_type}]})</span>
					</li>
				</td>
			</tr>
		</table>
		<table class="table selectable" class="ui-autocomplete ui-widget-content-custom ui-corner-all" id="ship_to_contact_list">
			<thead>
				<tr>
					<th>ID</th><th>Contact Name</th><th>Address 1</th><th> Country </th>
					<th> Province </th><th> City </th><th> Primary Cont No.</th>
					<th><a href="" class="close" ng-click="hideShiptoContact()">x</a></th>
				</tr>
			</thead>
			<tbody>
			<tr class="ui-menu-item" ng-repeat="contact in shipto" ng-click="selectShipTo(contact)">
				
				<td class="sid">{[{contact.id}]}</td>
				<td class="contact_name">{[{contact.contact_name}]}</td>
				<td class="address_1">{[{contact.address_1}]}</td>
				<td class="city">{[{contact.country}]}</td>
				<td class="city">{[{contact.province}]}</td>
				<td class="city">{[{contact.city}]}</td>
				<td class="city">
					<div class='phone' ng-repeat="phon in contact.phones" ng-if="$first">
						<span>{[{phon.number}]} (ext: {[{phon.phone_ext}]})</span>
					</div>
				</td>
				
				<td>
					
				</td>
				
			</tr>
			</tbody>
		</table>
		

		<input id="id_ship_to" name="ship_to" type="hidden">
	</div>

</td>
</tr>
<tr class="bg-success">	
	<th width="150">
		<label for="id_ship_via">Ship via:</label>
	</th>
	<td>
		<select class="form-control" id="id_ship_via" name="ship_via">
		{% for dc in delivery_choices %}
			<option value="{{dc.id}}">{{dc.delivery_choice}}</option>
		{% endfor %}
		</select>
	</td>

	<th width="150">
		<label for="id_deliver_internal">Department deliver internal:</label>
	</th>
	<td>
		<select class="form-control" id="id_deliver_internal" name="deliver_internal">
			{% for di in deliver_internals %}
			<option value="{{di.id}}">
				{{di.department}}
			</option>
			{% endfor %}
		</select>
	</td>
</tr>

<tr class="bg-success">
	<th width="150">
		<label for="id_shipping_inst">Shipping inst:</label>
	</th>
	<td colspan="3">
		<textarea class="form-control" cols="40" id="id_shipping_inst" name="shipping_inst" placeholder="Shipping Inst" rows="3"></textarea>
	</td>
</tr>

<tr class="bg-success">
	<th width="150">
		<label for="id_blanket_po">Blanket po:</label>
	</th>
	<td>
		<select class="form-control" id="id_blanket_po" name="blanket_po" placeholder="Blanket PO">
		<option value="0">NO</option>
		<option value="1">YES</option>
		</select>
	</td>

	<th>
		<label for="id_terms">Terms:</label>
	</th>
	<td colspan="3">
		<select class="form-control" id="id_terms" name="terms">
			{% for pt in terms %}
				<option value="{{pt.id}}" {% if pt.id = 2 %} selected="selected" {% endif %}>{{pt.term}}</option>
			{% endfor %}
		</select>
	</td>
</tr>
<tr class="bg-info">
	<th width="150">
		<label for="id_purchasing_agent">Purchasing agent:</label>
	</th>
	<td>
		<select class="form-control" id="id_purchasing_agent" name="purchasing_agent">
		{% for user in users %}
			<option value="{{user.id}}" {% if user.id == request.user.id %}selected='selected' {% endif %}>
				{{ user.first_name }} {{ user.last_name }}
			</option>
		{% endfor %}
		</select>
	</td>

	<th width="150">
		<label for="id_returned_type">Type:</label>
	</th>
	<td>
		<select class="form-control" id="id_returned_type" name="returned_type">
		<option value="0">Purchase Order</option>
		<option value="1">Return For Credit</option>
		<option value="2">Returned damaged Goods</option>
		<option value="3">Return For Repair</option>
		<option value="4">Return For Replacement</option>
		<option value="5">Return For RE-WORK</option>
		<option value="6">Returned Excessive Qty</option>
		<option value="7">Returned Wrong Material</option>
		</select>
	</td>
</tr>
<tr>
	<td colspan="4" align="center" ng-class="{'item_error ng-pristine': !item_added, 'bg-primary': item_added }">
		<span style="font-size: 14px; font-style: bold;">Add Items here for this purchase order</h4>
		<a href="/inventory/item/add/" class="btn btn-default" target="_blank">Add New Item To Inventory</a>
	</td>
</tr>
<tr>
	<td colspan="4" ng-class="{'item_error ng-pristine': !item_added, 'bg-info': item_added }">
		<div class="item_box">
						
			<table class="table item">
			<thead>
				<tr>
					<th width="120">Item Number</th>
					<th width="180">Description</th>
					<th width="120">Unit Measure</th>
					<th width="">Current Cost</th>
					<th width="100">Order Qty</th>
					<th width="150">Subtotal</th>
					<th width="">Job Number</th>
					<th width="180">Comments</th>
					<th width="100">Qty Recv To Date</th>
					<th width="100">Date Last Received</th>
					<th></th>
				</tr>
			</thead>
			<tbody id="add_item_list">
				<tr style="border-top: 2px dotted red;">
				<td style="position: relative;">
					<input type="text" class="form-control added_item_number" name="" value="" ng-model="search_item" ng-change="searchItem(search_item)" placeholder="search for item" autocomplete="off">

					<table class="table supplier_contact" id="items_list">
						<thead>
							<tr>
								<th width="110">Item Number</th>
								<th width="160">Description</th>
								<th>Unit Measure</th>
								<th>Wholesale Cost</th>
								<th>Currency</th>
								<th>Primary Supplier</th>
								<th>QTY on hand</th>
								<th>Qty on Order</th>
								<th>Last Ordered</th>
								<th><a href="" class="close" ng-click="hideItemList()">x</a></th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="it in po_items">
								<td>{[{item.item_number}]}</td>
								<td colspan="9">{[{item.description}]}</td>
							</tr>
							<tr ng-repeat="item in items" ng-click="selectItem(item)">
								<td>{[{item.item_number}]}</td>
								<td>{[{item.description}]}</td>
								<td>{[{item.item_unit_measure}]}</td>
								<td>{[{item.wholesale_cost}]}</td>
								<td>{[{item.currency}]}</td>
								<td>{[{item.primary_supplier.contact_name}]}</td>
								<td>{[{item.quantity_on_hand}]}</td>
								<td>{[{item.quantity_on_order}]}</td>
								<td>{[{item.last_ordered}]}</td>
								<td></td>
								
								
							</tr>

							<tr ng-show="!items.length">
								<td colspan="10">No Items</td>
							</tr>
						</tbody>

					</table>
				</td>
				<td>
					<textarea rows="1" class="form-control demo_box" readonly=""></textarea>
				</td>
				<td>
					<select class="form-control" disabled="true">
					{% for unit_measue in item_unit_measures %}
						<option value="{{unit_measue.id}}">{{unit_measue.unit_name}}</option>
					{% endfor %}
					</select>
				</td>
				<td>
					<input type="currency" class="form-control demo_box" placeholder="Cost"readonly="readonly">
				</td>
				<td>
					<input type="number" class="form-control demo_box" placeholder="Qty" readonly="readonly">
				</td>
				<td>
					<input type="currency" step="0.0001" class="form-control demo_box" placeholder="Subtotal" readonly="readonly">
				</td>
				<td>
					
					<input type="text" class="form-control demo_box" placeholder="job number" autocomplete="off" readonly="readonly">
				</td>
				<td>
					<textarea rows="1" class="form-control demo_box" placeholder="Put your comments here" readonly="readonly"></textarea>
				</td>
				<td>
					<input type="number" step="0.01" class="form-control" placeholder="Qty Received" readonly="readonly">
				</td>
				<td>
					<input type="text" class="form-control" placeholder="Last Recv Date" readonly="readonly">
				</td>
				<td></td>
				</tr>
				<tr class="footer"></tr>			
			</tbody>
			<tr id='calculated_total_amount'>
				<td width="150">
					Items Total Qty:
				</td>
				<td colspan="2">
					<span id='items_total_qty'>0.0</span>
					<input class="form-control" id="id_items_total" name="items_total" type="hidden">
				</td>
				<td colspan="2">Total Amount</td>
				<td width="120">{{ currency.get_currency_icon }}<span class="amount">0</span></td>
				<td width="10" colspan="5"></td>
			</tr>
				
			</table>
				
		</div>
	</td>	

</tr>

<tr class="bg-success">
	<th width="150">
		<label for="id_hst_taxable">Hst taxable:</label>
	</th>
	<td>
		<select class="form-control tax" ng-model="hst_tax" id="id_hst_taxable" name="hst_taxable" ng-change="updateHST({[{hst_tax}]})">
		<option value="0">NO</option>
		<option value="1">YES</option>
		</select>
		
		<input class="form-control decimal tax" ng-if="hst_tax" ng-model="hst_tax_amount" ng-blur="addHstAmount($event)" id="id_hst_taxable_amount" name="hst_taxable_amount" placeholder="HST Taxable Amount" type="text">
	</td>
	<th width="150">
		<label for="id_pst_taxable">Pst taxable:</label>
	</th>
	<td>
		<select class="form-control tax" ng-model="pst_tax" id="id_pst_taxable" name="pst_taxable" ng-change="updatePST(pst_tax)">
		<option value="0">NO</option>
		<option value="1">YES</option>
		</select>
		<input class="form-control decimal tax" ng-if="pst_tax" ng-model="pst_tax_amount" id="id_pst_taxable_amount" name="pst_taxable_amount" ng-blur="addPstAmount($event)" placeholder="PST Taxable Amount" value="0.0" type="text">
	</td>
</tr>

<tr class="bg-info">
	<th width="150">
		<label for="id_po_currency">Po currency:</label>
	</th>
	<td>
		<select class="form-control" id="id_po_currency" name="po_currency">
		{% for currency in currencies %}
		<option data-currency-icon="{{ currency.get_currency_icon }}" value="{{currency.id}}" {% if currency.id == 1 %} selected="selected" {% endif %}>
				{{ currency.currency }} ({{ currency.get_currency_icon }})
			</option>
		{% endfor %}
		</select>
	</td>
	<th width="150">
		<label for="id_total_po_amount">Total po amount:</label>
	</th>
	<td>
		<input class="form-control" ng-model="total_amount" id="id_total_po_amount" name="total_po_amount" value="0.0" readonly="readonly" type="text">
	</td>
</tr>

<tr>
	<td>
		
		
	</td>
	<td colspan="2">
		<label>PDF PO </label> <input type="checkbox" data-toggle="toggle" data-on="Yes" data-off="No" name="pdf_po" style="margin-left: 10px; margin-right: 20px;">
		<label>Print PO</label><input type="checkbox" data-toggle="toggle" data-on="Yes" data-off="No"  name="print_po" style="margin-left: 10px; margin-right: 20px;">
		<label>Email PO</label><input type="checkbox" data-toggle="toggle" data-on="Yes" data-off="No" name="email_po" style="margin-left: 10px; margin-right: 20px;">
		<label>Fax PO</label><input type="checkbox" data-toggle="toggle" data-on="Yes" data-off="No" name="fax_po" style="margin-left: 10px; margin-right: 20px;">
	</td>
	<td>
		<button type="submit" ng-show="show_update_button" class="btn btn-primary btn-large form-control" ng-disabled="!(purchase_add_form.$valid && purchase_add_form.$dirty && item_added)">Update PO</button>
		<button type="submit" ng-show="show_add_button" class="btn btn-primary btn-large form-control" ng-disabled="!(purchase_add_form.$valid && purchase_add_form.$dirty && item_added)">Create PO</button>
	</td>
</tr>
</table>